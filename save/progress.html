<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
    #canvas {
    	display: block;
    	width: 300px;
    	margin: 100px auto;
        background-color: #000
    }
    </style>
    <script>
        window.onload = function(){

    	var canvas = document.getElementById("canvas");
    	var ctx = canvas.getContext("2d");

    	var W = canvas.width;
    	var H = canvas.height;

    	var degrees = 0;
    	var new_degrees = 0;
    	var difference = 0;
    	var color = "tomato";
    	var bgcolor = "#FFF";
    	var text;
    	var animation_loop, redraw_loop;

    	function init()
    	{
    		ctx.clearRect(0, 0, W, H);
            //바탕 반원
    		ctx.beginPath();
    		ctx.strokeStyle = bgcolor;
    		ctx.lineWidth = 3;
    		ctx.arc(W/2, H/2, 92, Math.PI, 0, false);
    		ctx.stroke();
            //게이지
    		var radians = degrees * Math.PI / 180;
    		ctx.beginPath();
    		ctx.strokeStyle = color;
    		ctx.lineWidth = 3;

    		ctx.arc(W/2, H/2, 92, Math.PI, radians - 180*Math.PI/180, false);

    		ctx.stroke();
    	}

    	function draw()
    	{

    		if(typeof animation_loop != undefined) clearInterval(animation_loop);

    		new_degrees = Math.round(Math.random()*180);
    		difference = new_degrees - degrees;

    		animation_loop = setInterval(animate_to, 1000/difference);
    	}

    	function animate_to()
    	{
    		if(degrees == new_degrees)
    			clearInterval(animation_loop);
    		if(degrees < new_degrees)
    			degrees++;
    		else
    			degrees--;
    		init();
    	}

    	draw();
    	
    }
    </script>
</head>
<body>
    <canvas id="canvas" width="300" height="300">
</body>
</html>
